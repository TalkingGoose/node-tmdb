{"version":3,"sources":["shows/interface.es6"],"names":[],"mappings":"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","file":"shows/interface.js","sourcesContent":["/**\r\n * Created by Paul on 06/08/2016.\r\n */\r\n\r\n'use strict';\r\n\r\nconst util = require('util');\r\nconst TypeOf = require('typeof');\r\n\r\nconst Show = require('./show');\r\nconst request = require('../libs/timed-request');\r\nconst {Templates} = require('../config');\r\n\r\nfunction Interface(instance, options) {\r\n    if (!(this instanceof Interface)) {\r\n        return new Interface(instance, options);\r\n    }\r\n\r\n    Interface.super_.call(this);\r\n\r\n    this.instance = instance;\r\n    this.options = options;\r\n\r\n    return this;\r\n}\r\n\r\nutil.inherits(Interface, Object);\r\n\r\nObject.defineProperties(Interface.prototype, {\r\n    'search': {\r\n        'value': function(data, callback) {\r\n            let requestData = Object.assign({}, Templates.GET, {\r\n                'url': Templates.URL.replace('$', 'search/tv'),\r\n                'qs': Object.assign({}, { 'api_key': this.instance.apikey }, data)\r\n            });\r\n\r\n            request(requestData, (error, response, body) => {\r\n                if (error) {\r\n                    return callback(error);\r\n                }\r\n\r\n                let jsonData = JSON.parse(body);\r\n                let results = jsonData.results;\r\n\r\n                if (TypeOf.isArray(results)) {\r\n                    jsonData.results = results.map((data) => new Show(this.instance, data));\r\n                }\r\n\r\n                return callback(null, jsonData);\r\n            });\r\n        }\r\n    },\r\n\r\n    'genres': {\r\n        'value': (function() {\r\n            let LAST_UPDATE = (new Date());\r\n            let RESULT = null;\r\n            return function(callback) {\r\n                if (RESULT !== null) {\r\n                    let diff = ((new Date()) - LAST_UPDATE);\r\n                    if (diff < 1e6) {\r\n                        return RESULT;\r\n                    }\r\n\r\n                    LAST_UPDATE = (new Date());\r\n                }\r\n\r\n                let requestData = Object.assign({}, Templates.GET, {\r\n                    'url': Templates.URL.replace('$', 'genre/tv/list'),\r\n                    'qs': Object.assign({}, { 'api_key': this.instance.apikey })\r\n                });\r\n\r\n                request(requestData, (error, response, body) => {\r\n                    if (error) {\r\n                        return callback(error);\r\n                    }\r\n\r\n                    RESULT = JSON.parse(body);\r\n\r\n                    return callback(null, RESULT);\r\n                });\r\n            };\r\n        }())\r\n    },\r\n\r\n    'from': {\r\n        'value': function(data) {\r\n            return new Show(data);\r\n        }\r\n    }\r\n});\r\n\r\nmodule.exports = Interface;\r\n"],"sourceRoot":"/source/"}