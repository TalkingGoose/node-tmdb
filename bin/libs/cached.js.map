{"version":3,"sources":["libs/cached.es6"],"names":[],"mappings":"AAAA;;;;AAIA;;;;AAEA,IAAM,WAAW,QAAQ,aAAR,CAAjB;;AAEA,OAAO,OAAP,GAAiB,UAAS,MAAT,EAAiB,MAAjB,EAAyB;AACtC,QAAI,QAAQ,IAAZ;AACA,QAAI,gBAAgB,IAApB;AACA,QAAI,YAAY,KAAhB;AACA,QAAI,QAAQ,EAAZ;;AAEA,WAAO,UAAS,QAAT,EAAmB;AACtB,YAAI,SAAJ,EAAe;AACX,kBAAM,IAAN,CAAW,QAAX;AACA;AACH;;AAED,YAAI,UAAU,IAAV,IAAkB,SAAS,aAAT,IAA0B,MAAhD,EAAwD;AACpD,yDAAY,KAAZ;AACH;;AAED,oBAAY,IAAZ;AACA,eAAO,IAAP,CAAY,IAAZ,EAAkB,YAAgB;AAAA,8CAAZ,OAAY;AAAZ,uBAAY;AAAA;;AAC9B,wBAAY,KAAZ;AACA,oBAAQ,OAAR;;AAEA,gBAAI,WAAW,IAAf;AACA,mBAAO,CAAC,WAAW,MAAM,KAAN,EAAZ,MAA+B,SAAtC,EAAiD;AAC7C,6DAAY,KAAZ;AACH;AACJ,SARD;AASH,KApBD;AAqBH,CA3BD","file":"libs/cached.js","sourcesContent":["/**\r\n * Created by Paul on 07/08/2016.\r\n */\r\n\r\n'use strict';\r\n\r\nconst timeDiff = require('./time-diff');\r\n\r\nmodule.exports = function(target, expire) {\r\n    let cache = null;\r\n    let lastRetrieval = null;\r\n    let isPending = false;\r\n    let queue = [];\r\n\r\n    return function(callback) {\r\n        if (isPending) {\r\n            queue.push(callback);\r\n            return;\r\n        }\r\n\r\n        if (cache !== null && timeDiff(lastRetrieval) < expire) {\r\n            callback(...cache);\r\n        }\r\n\r\n        isPending = true;\r\n        target.call(this, (...results) => {\r\n            isPending = false;\r\n            cache = results;\r\n\r\n            let callback = null;\r\n            while ((callback = queue.shift()) !== undefined) {\r\n                callback(...cache);\r\n            }\r\n        });\r\n    };\r\n};\r\n"],"sourceRoot":"/source/"}